---
- name: Finding ERS node name
  ansible.builtin.include_role:
    name: sap.cluster_qa.pcs_find_ers

- name: Setting initial facts
  ansible.builtin.set_fact:
    test10_sap_ascs_node_name_initial: "{{ sap_ascs_node_name }}"
    test10_sap_ers_node_name_initial: "{{ sap_ers_node_name }}"
    test10_message_server_killed: false
    sap_ascs_node_name_initial: "{{ sap_ascs_node_name }}"  # noqa: var-naming[no-role-prefix]
    sap_ers_node_name_initial: "{{ sap_ers_node_name }}"  # noqa: var-naming[no-role-prefix]
    message_server_killed: false  # noqa: var-naming[no-role-prefix]

- name: Verify ASCS and ERS are on different nodes initially
  ansible.builtin.assert:
    that: test10_sap_ascs_node_name_initial != test10_sap_ers_node_name_initial
    fail_msg: "ASCS and ERS are on the same node initially, which violates HA setup requirements"
    success_msg: "ASCS on {{ test10_sap_ascs_node_name_initial }}, ERS on {{ test10_sap_ers_node_name_initial }} - proper HA setup confirmed"
